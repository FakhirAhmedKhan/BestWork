import{r,j as o}from"./index-VmQNPl12.js";import{a as v}from"./index-ngrFHoWO.js";import{m as l}from"./proxy-CH5aDltB.js";const w={surfaces:{chatBot:"fixed right-5 bottom-2 flex w-[300px] max-w-md flex-col rounded-lg border border-white/10 bg-white/30 shadow-2xl backdrop-blur-md"},components:{chatHistory:"hide-scrollbar flex h-[300px] flex-col gap-2 overflow-y-auto p-4"}},N=w.surfaces.chatBot,D=w.components.chatHistory;function A({show:j}){const[y,u]=r.useState([]),[s,c]=r.useState([]),[d,h]=r.useState(""),[f,p]=r.useState(!1),g=r.useRef(null),m=r.useRef(new Map),x=r.useMemo(()=>y.map(({question:e,answer:a},t)=>`Q${t+1}: ${e}
A${t+1}: ${a}`).join(`

`),[y]);r.useEffect(()=>{const e=localStorage.getItem("trainingData");e?u(JSON.parse(e)):v.get("https://raw.githubusercontent.com/FakhirAhmedKhan/DataApi-main/refs/heads/main/Data/trainingData.json").then(a=>{const t=a.data.trainingData||[];u(t),localStorage.setItem("trainingData",JSON.stringify(t))}).catch(a=>console.error("Error fetching Data:",a))},[]),r.useEffect(()=>{g.current?.scrollTo({top:g.current.scrollHeight,behavior:"smooth"})},[s,f]);const b=r.useCallback(async(e,a)=>{if(e.length){if(m.current.has(a)){const t=m.current.get(a);c(n=>[...n,{role:"model",text:t}]);return}p(!0);try{const t=await fetch("https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=AIzaSyDxNRzdeVtQEKv5r5R_BAhmPLm296ysAcg",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:[...x?[{role:"user",parts:[{text:x}]}]:[],...e.map(({role:i,text:k})=>({role:i,parts:[{text:k}]}))]})});if(!t.ok){const i=await t.json();console.error("API Error:",i),p(!1);return}const n=(await t.json())?.candidates?.[0]?.content?.parts?.[0]?.text?.replace(/<[^>]+>/g,"").trim();n&&(m.current.set(a,n),c(i=>[...i,{role:"model",text:n}]))}catch(t){console.error("Bot response error:",t)}finally{p(!1)}}},[x]),S=r.useCallback(async e=>{e.preventDefault();const a=d.trim();if(!a)return;const t=[...s,{role:"user",text:a}];c(t),h(""),await b(t,a)},[d,s,b]);return j?o.jsxs(l.section,{className:`${N} fixed bottom-6 right-6 w-80 md:w-96 h-[500px] rounded-2xl shadow-2xl bg-white dark:bg-gray-900 border border-gray-200 dark:border-gray-700 flex flex-col`,initial:{opacity:0,scale:.8,y:40},animate:{opacity:1,scale:1,y:0},transition:{type:"spring",stiffness:120,damping:15},children:[o.jsxs("div",{ref:g,className:`${D} flex-1 overflow-y-auto p-4 space-y-4`,children:[s.length===0&&o.jsx(l.div,{initial:{opacity:0,x:-30},animate:{opacity:1,x:0},className:"flex items-start gap-2",children:o.jsx("span",{className:"px-4 py-2 rounded-xl bg-indigo-100 text-indigo-800 dark:bg-indigo-800 dark:text-indigo-100 shadow-sm",children:"ðŸ¤– Hi there! Welcome to my portfolio. How may I assist you today?"})}),s.map((e,a)=>o.jsx(l.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},className:`flex ${e.role==="user"?"justify-end":"justify-start"}`,children:o.jsx("div",{className:`px-4 py-2 max-w-[75%] rounded-xl shadow-sm ${e.role==="user"?"bg-indigo-500 text-white rounded-br-none":"bg-gray-100 dark:bg-gray-800 text-gray-800 dark:text-gray-200 rounded-bl-none"}`,children:e.text})},a)),f&&o.jsx(l.div,{initial:{opacity:0},animate:{opacity:1},className:"flex justify-start gap-2",children:o.jsx("span",{className:"px-4 py-2 rounded-xl bg-gray-100 dark:bg-gray-800 text-gray-800 dark:text-gray-200 shadow-sm animate-pulse",children:"ðŸ¤– Bot is typing..."})})]}),o.jsx("form",{onSubmit:S,className:"p-3 border-t border-gray-200 dark:border-gray-700 flex items-center gap-2",children:o.jsx("input",{type:"text",placeholder:"Type a message...",value:d,onChange:e=>h(e.target.value),className:"flex-1 px-4 py-2 rounded-xl","aria-label":"Type your message"})})]}):null}export{A as default};
